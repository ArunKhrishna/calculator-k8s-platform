apiVersion: v1
kind: ConfigMap
metadata:
  name: calculator-config
  namespace: {{ index .Values.services 0 "namespace" }}
data:
  DB_HOST: {{ .Values.database.host | quote }}
  DB_PORT: {{ .Values.database.port | quote }}
  DB_NAME: {{ .Values.database.name | quote }}
  DB_USER: {{ .Values.database.user | quote }}
  {{- range .Values.services }}
  {{- if .env }}
  {{- range $key, $value := .env }}
  {{ $key }}: {{ $value | quote }}
  {{- end }}
  {{- end }}
  {{- end }}